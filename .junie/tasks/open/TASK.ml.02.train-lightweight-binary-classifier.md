

# TASK.ml.02.train-lightweight-binary-classifier

## Title
Train Lightweight Binary Classifier for GPU Detection

## Status
Open

## Related Epic
EPIC.loader.shopify-source-loader.md

## Related Tasks
- TASK.loader.03.load-shopify-wamatek-json.md
- TASK.ml.01.heuristic-labeling-binary-classification.md
- TASK.ml.03.semantic-similarity-enhancement.md (planned)

## Context
The current input datasets derived from Shopify sources (e.g. Wamatek) contain noisy entries — not all listings are GPUs. While heuristic labeling provides an initial set of weak binary labels (`is_gpu: true | false`), we aim to generalize this with a trainable binary classifier.

The intent is to identify whether a given listing is GPU-related or not, improving precision of the `normalize` and `enrich` stages of the pipeline. Later, this can be extended to support few-shot and embedding-based ranking.

## Objective
Train a lightweight binary classification model that can accept tabular listing features (e.g. title, price, seller, region) and return a probability or hard label (`is_gpu`) indicating GPU-relevance.

## Requirements

- Load dataset from pre-labeled CSV (generated by `TASK.ml.01`)
- Use only lightweight models (e.g. logistic regression, decision tree, or gradient-boosted trees)
- Model input fields: title (str), price (float), quantity (int), seller (str), region (str), condition (str)
- Optional: Try one-hot encoding categorical features (e.g. condition, region)
- Evaluation:
  - Print accuracy, precision, recall, F1
  - Display confusion matrix
  - Save model to disk (e.g. `models/binary_gpu_classifier.pkl`)
- Use Scikit-learn or similar package
- Code must live in `glyphsieve/ml` as `binary_classifier.py`
- Add CLI entrypoint: `uv run glyphsieve ml-binary-train`

## Acceptance Criteria
- ✅ Loads labeled input CSV
- ✅ Trains a binary classifier with at least 85% accuracy
- ✅ Prints evaluation metrics to stdout
- ✅ Saves trained model to disk
- ✅ CLI runnable via `uv`
- ✅ Lints cleanly with flake8, ruff, black, isort
- ✅ Test coverage for model loading and prediction logic
- ✅ Uses only approved dependencies (`scikit-learn`, `pandas`, `numpy`)

## Notes
- Do not use transformers or LLM-based models. This task is meant to be fast, interpretable, and embeddable in a pipeline.
- Follow established style in `glyphsieve` and prior ML utilities.

## Future Work
- TASK.ml.03.semantic-similarity-enhancement.md
- TASK.ml.04.integrate-binary-predictor-into-pipeline.md